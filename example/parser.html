<!doctype html>
<html>
    <head>
        <title>
            Parser example
        </title>
    </head>
    <body>
    <script src="../src/regex-start-substring.js"></script>
    <script src="../src/regex-string.js"></script>
    <script src="../src/regex-number.js"></script>
    <script src="../src/regex-identifier.js"></script>
    <script src="../src/tok.js"></script>
    <script src="../src/par.js"></script>
    <script>
        var testString = '\nvar gbDebuggerControls =\n\'<div class="FL MT MR MB">\\\n<table>\\\n<thead><tr><th colspan="2" style="min-width:270px;">Assembler</th></tr></thead>\\\n<tbody><tr><td colspan="2">\\\n<input class="BTN" type="button" onclick="gb_Clear_All_Breakpoints();" value="Clear all breakpoints"/>\\\n<input class="BTN" type="button" onclick="gb_GoTo_ASM(prompt(\\\'Enter address (in hex)\\\'));" value="Goto..."/>\\\n<input class="BTN" type="button" onclick="alert(gb_Dump_Caller_Stack());" value="Caller stack..."/>\\\n</td></tr>\\\n<tr>\\\n<td id="ASMDUMP">data</td>\\\n<td id="ASMSCROLL">s</td>\\\n</tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n\\\n<div class="FL MT MR MB">\\\n<table>\\\n<thead><tr><th colspan="2">Memory dump</th></tr></thead>\\\n<tbody>\\\n<tr><td colspan="2">\\\n<input value="ROM0" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0x0000/(0xFFFF-dump_mem_a));gb_gb_Dump_Mem();"/>\\\n<input value="ROM1" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0x4000/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="VRAM" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0x8000/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="OAM" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0xFE00/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="PC" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,PC/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="SP" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,SP/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="HL" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,HL/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n</td></tr>\\\n<tr>\\\n<td id="MEMDUMP">a</td>\\\n<td id="MEMSCROLL">s</td>\\\n</tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n\\\n<div class="FL">\\\n<table class="FL MT MR MB C">\\\n<thead><tr><th colspan="2">CPU Dump</th></tr></thead>\\\n<tbody>\\\n<tr><td id="RA">A</td><td id="RF">F</td></tr>\\\n<tr><td id="RB">B</td><td id="RC">C</td></tr>\\\n<tr><td id="RD">D</td><td id="RE">E</td></tr>\\\n<tr><td colspan="2" id="HL">HL</td></tr>\\\n<tr><td colspan="2" id="SP">SP</td></tr>\\\n<tr><td colspan="2" id="PC">PC</td></tr>\\\n</tbody>\\\n</table>\\\n\\\n<table class="MT MR C CLR">\\\n<thead><tr><th>Cartridge Info</th></tr></thead>\\\n<tbody>\\\n<tr><td class="L" id="ROM_INFO">info</td></tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n\\\n<div class="FL MT MR MB">\\\n<table>\\\n<thead><tr><th>Special regs</th></tr></thead>\\\n<tbody><tr><td id="SPRDUMP">data</td></tr></tbody>\\\n</table>\\\n</div>\\\n\\\n<!--\\\n<div class="FL MR CLR">\\\n<table class="C FL MR">\\\n<thead><tr><th>Tile images</th></tr></thead>\\\n<tbody>\\\n<tr><td id="TILES">tiles</td></tr>\\\n</tbody>\\\n</table>\\\n\\\n<table class="FL MR MB">\\\n<thead><tr><th>Background buffer</th></tr></thead>\\\n<tbody>\\\n<tr><td>\\\n<canvas id="BG_CANVAS" width="512" height="512"></canvas>\\\n<hr/>\\\n<span id="BG_INFO"></span>\\\n<input type="button" value="update" onclick="gb_Dump_Background()"/>\\\n</td></tr>\\\n</tbody>\\\n</table>\\\n\\\n\\\n<table class="FL MR MB">\\\n<thead><tr><th>Sprites</th></tr></thead>\\\n<tbody>\\\n<tr><td>\\\n<canvas style="background:#C8FFD0;" id="SP_CANVAS" width="160" height="144"></canvas>\\\n<hr/>\\\n<span id="SP_INFO"></span>\\\n</td></tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n-->\\\n\';\n\n\n\nvar gbRunInterval;\nvar gbFpsInterval;\n\nfunction gb_Frame() {\n  gbEndFrame=false;\n  while (!(gbEndFrame||gbPause)) {\n    if (!gbHalt) OP[MEMR(PC++)](); else gbCPUTicks=4;\n    if (gbIME) gbInterrupts[gbRegIE & gbRegIF]();\n    gb_TIMER_Control();\n    if (gbIsBreakpoint) if (gbBreakpointsList.indexOf(PC)>=0) {\n      gb_Pause();\n      gb_Toggle_Debugger(true);\n    }  \n  }\n}\n\nfunction gb_Step(){\n  if (!gbHalt) OP[MEMR(PC++)](); else gbCPUTicks=4;\n  if (gbIME) gbInterrupts[gbRegIE & gbRegIF]();\n  gb_TIMER_Control();\n  gb_Dump_All();\n}\n\nfunction gb_Run() {\n  if (!gbPause) return;\n  gbPause=false;\n  $(\'BR\').disabled=1;\n  $(\'BP\').disabled=0;\n  $(\'BS\').disabled=1;\n  gbFpsInterval=setInterval(gb_Show_Fps,1000);\n  gbRunInterval=setInterval(gb_Frame,16);\n}\n';
        testString = 'var gbDebuggerControls =\n\'<div class="FL MT MR MB">\\\n<table>\\\n<thead><tr><th colspan="2" style="min-width:270px;">Assembler</th></tr></thead>\\\n<tbody><tr><td colspan="2">\\\n<input class="BTN" type="button" onclick="gb_Clear_All_Breakpoints();" value="Clear all breakpoints"/>\\\n<input class="BTN" type="button" onclick="gb_GoTo_ASM(prompt(\\\'Enter address (in hex)\\\'));" value="Goto..."/>\\\n<input class="BTN" type="button" onclick="alert(gb_Dump_Caller_Stack());" value="Caller stack..."/>\\\n</td></tr>\\\n<tr>\\\n<td id="ASMDUMP">data</td>\\\n<td id="ASMSCROLL">s</td>\\\n</tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n\\\n<div class="FL MT MR MB">\\\n<table>\\\n<thead><tr><th colspan="2">Memory dump</th></tr></thead>\\\n<tbody>\\\n<tr><td colspan="2">\\\n<input value="ROM0" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0x0000/(0xFFFF-dump_mem_a));gb_gb_Dump_Mem();"/>\\\n<input value="ROM1" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0x4000/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="VRAM" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0x8000/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="OAM" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,0xFE00/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="PC" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,PC/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="SP" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,SP/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n<input value="HL" class="BTN" type="button" onclick="memScroll.dragger.setpos(0,HL/(0xFFFF-dump_mem_a));gb_Dump_Mem();"/>\\\n</td></tr>\\\n<tr>\\\n<td id="MEMDUMP">a</td>\\\n<td id="MEMSCROLL">s</td>\\\n</tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n\\\n<div class="FL">\\\n<table class="FL MT MR MB C">\\\n<thead><tr><th colspan="2">CPU Dump</th></tr></thead>\\\n<tbody>\\\n<tr><td id="RA">A</td><td id="RF">F</td></tr>\\\n<tr><td id="RB">B</td><td id="RC">C</td></tr>\\\n<tr><td id="RD">D</td><td id="RE">E</td></tr>\\\n<tr><td colspan="2" id="HL">HL</td></tr>\\\n<tr><td colspan="2" id="SP">SP</td></tr>\\\n<tr><td colspan="2" id="PC">PC</td></tr>\\\n</tbody>\\\n</table>\\\n\\\n<table class="MT MR C CLR">\\\n<thead><tr><th>Cartridge Info</th></tr></thead>\\\n<tbody>\\\n<tr><td class="L" id="ROM_INFO">info</td></tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n\\\n<div class="FL MT MR MB">\\\n<table>\\\n<thead><tr><th>Special regs</th></tr></thead>\\\n<tbody><tr><td id="SPRDUMP">data</td></tr></tbody>\\\n</table>\\\n</div>\\\n\\\n<!--\\\n<div class="FL MR CLR">\\\n<table class="C FL MR">\\\n<thead><tr><th>Tile images</th></tr></thead>\\\n<tbody>\\\n<tr><td id="TILES">tiles</td></tr>\\\n</tbody>\\\n</table>\\\n\\\n<table class="FL MR MB">\\\n<thead><tr><th>Background buffer</th></tr></thead>\\\n<tbody>\\\n<tr><td>\\\n<canvas id="BG_CANVAS" width="512" height="512"></canvas>\\\n<hr/>\\\n<span id="BG_INFO"></span>\\\n<input type="button" value="update" onclick="gb_Dump_Background()"/>\\\n</td></tr>\\\n</tbody>\\\n</table>\\\n\\\n\\\n<table class="FL MR MB">\\\n<thead><tr><th>Sprites</th></tr></thead>\\\n<tbody>\\\n<tr><td>\\\n<canvas style="background:#C8FFD0;" id="SP_CANVAS" width="160" height="144"></canvas>\\\n<hr/>\\\n<span id="SP_INFO"></span>\\\n</td></tr>\\\n</tbody>\\\n</table>\\\n</div>\\\n-->\\\n\';  foo();';
        console.log("testing", [testString.replace(/\n/g,'\u23CE')]);
        var par = new Par(testString);
        par.run();
        console.log("finished...", Tok[par.tok.lastBlack]);
    </script>
    </body>
</html>
